{% extends "base.html" %}
{% block title %}CVEs{% endblock %}
{% block content %}
    <a name="top"></a>
    {% for key, items in index|dictsort %}
        {% if key == 'CVE' %}
        <table cellpadding="10" border="1">
            <tr>
                {% for cve_year,_ in items|dictsort %}
                <td><a href="#cve_{{cve_year}}">{{cve_year}}</a></td>
                {% endfor %}
            </tr>
        </table>
        {% for cve_year, cves in items|dictsort|reverse %}
            <a name="cve_{{cve_year}}"><h2>{{cve_year}}</h2></a>
                <table>
                    <tr>
                        <td><a href="#top">Back to top</a></td>
                    </tr>
                </table>
            <table cellpadding="10" border="1">
                <tr>
                    {% for prefix,_ in cves|dictsort %}
                    <td><a href="#cve_{{cve_year}}_{{prefix}}">{{cve_year}}-{{prefix}}xx</a></td>
                    {% endfor %}
                </tr>
            </table>
            {% for prefix, ids in cves|dictsort %}
                <a name="cve_{{cve_year}}_{{prefix}}"><h3>CVE-{{cve_year}}-{{prefix}}xx</h3></a>
                <table>
                    <tr>
                        <td><a href="#top">Back to top</a></td>
                        <td><a href="#cve_{{cve_year}}">Back to {{cve_year}}</a></td>
                    </tr>
                </table>
                <table>
                    {% set step = 5 %}
                    {% set sorted_ids = ids|sort %}
                    {% for x in range(ids|count // step + 1) %}
                    <tr>
                        {% for name, id in sorted_ids[step*x:step*(x+1)] %}
                        <td width="200"><a href="./{{id}}.html">{{name}}</a></td>
                        {% endfor %}
                    </tr>
                    {% endfor %}
                </table>
            {% endfor %}
            <hr>
        {% endfor %}
        {% else %}
        {% endif %}
    {% endfor %}
{% endblock %}
