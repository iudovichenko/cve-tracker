{% extends "base.html" %}
{% block title %}{{obj.name}}-{{obj.version}}{% endblock %}
{% block content %}
    <h1>{{obj.name}} {{obj.version}}</h1>

    <table border="1" cellpadding="5">
        <tr>
            <td bgcolor="grey">Project</td>
            <td><a href="../source-project/{{obj.source_package.project.id}}.html">{{obj.name}}</a></td>
        </tr>
        <tr>
            <td bgcolor="grey">Version</td>
            <td><a href="../source-package/{{obj.source_package.id}}.html">{{obj.version}}</a></td>
        </tr>
        <tr>
            <td bgcolor="grey">Distribution</td>
            <td><a href="../distribution/{{obj.distribution.id}}.html">{{obj.distribution}}</a></td>
        </tr>
    </table>

    <h2>Product Packages</h2>
    <table border="1" cellpadding="5">
        <tr bgcolor="grey">
            <th>Package</th>
            <th>Version</th>
            <th>Product</th>
        </tr>
        {% for x in obj.product_packages %}
            <tr>
                <td><a href="../source-project/{{x.source_package.project.id}}.html">{{x.source_package.name}}</a></td>
                <td><a href="../product-package/{{x.id}}.html">{{x.version}}</a></td>
                <td><a href="../product/{{x.product.id}}.html">{{x.product}}</a></td>
            </tr>
        {% endfor %}
    </table>
{#
    <h2>Advisories</h2>
    <ul>
        {% for x in obj.advisories %}
        <li><a href="../advisory/{{x.id}}.html">{{x.name}}</a></li>
        {% endfor %}
    </ul>
#}
    <h2>CVEs</h2>
    <table border="1" cellpadding="5">
        <tr bgcolor="grey">
            <th>CVE</th>
            <th>Affected</th>
            <th>Resolved</th>
        </tr>
        {% set related_issues = obj.related_issues(merge=True) %}
        {% for _,x in related_issues|dictsort %}
            {% set is_tracked, issues = x %}
            {% set issue = issues[0] %}
        <tr>
            <td><a href="../cve/{{issue.issue.id}}.html">{{issue.issue.name}}</a></td>
            {% if is_tracked %}
            <td bgcolor="{{'red' if issue.affected else 'green'}}">{{issue.affected}}</td>
            <td bgcolor="{{'green' if issue.resolved else 'red'}}">{{issue.resolved}}</td>
            {% else %}
            <td bgcolor="lightgrey">N/A</td>
            <td bgcolor="red">No</td>
            {% endif %}
        </tr>
        {% endfor %}
    </table>
{% endblock %}
