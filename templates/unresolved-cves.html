{% extends "base.html" %}
{% block title %}Unresolved CVEs{% endblock %}
{% block content %}
    <table border="1" cellpadding="5">
        <tr bgcolor="grey">
            <th>Product</th>
            <th>Packages Affected</th>
            <th>CVEs Affected</th>
            <th>CVEs Resolved</th>
        </tr>
    {% for name,stat in data['stat']|dictsort %}
        <tr>
            <td>{{name}}</td>
            <td>{{stat['packages']|count}}</td>
            <td>{{stat['affected']}}</td>
            <td>{{stat['resolved']}}</td>
        </tr>
    {% endfor %}
    </table>

    {% for name,objs in data['objs']|dictsort %}
    <h2>{{name}}</h2>
    <table border="1" cellpadding="5">
        <tr bgcolor="grey">
            <th>Project</th>
            <th>Version</th>
            <th>Product</th>
            <th>Distribution</th>
            <th>CVEs</th>
        </tr>
        {% for x in objs %}
        <tr>
            <td><a href="{{root}}/source-project/{{x.source_package.project.id}}.html">{{x.name}}</a></td>
            <td><a href="{{root}}/product-package/{{x.id}}.html">{{x.version}}</a></td>
            <td><a href="{{root}}/product/{{x.product.id}}.html">{{x.product}}</a></td>
            <td><a href="{{root}}/distribution/{{x.distribution.id}}.html">{{x.distribution}}</a></td>
            <td>
                <table>
                    <tr>
                        <th>CVE</th>
                        <th>Affected</th>
                        <th>Resolved</th>
                    </tr>
                {% for issue in x.issues() %}
                    <tr>
                        <td><a href="{{root}}/cve/{{issue.issue.id}}.html">{{issue.issue.name}}</a></td>
                        <td bgcolor="{{'red' if issue.affected else 'green'}}">{{issue.affected}}</td>
                        <td bgcolor="{{'green' if issue.resolved else 'red'}}">{{issue.resolved}}</td>
                    </tr>
                {% endfor %}
                </table>
            </td>
        </tr>
        {% endfor %}
    </table>
    {% endfor %}
{% endblock %}