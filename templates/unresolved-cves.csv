{% set sep = ';' %}
Project{{sep}}Version{{sep}}Product{{sep}}Distribution{{sep}}CVE{{sep}}Affected{{sep}}Resolved
{% for name, objs in data['objs']|dictsort %}
{% for _,t in objs|dictsort %}
{% for x, related_issues in t %}
{% set prefix = "{{name}};{{x.version}};{{x.product}};{{x.product_distribution}}" %}
{% for _,y in related_issues|dictsort %}
{% set is_tracked, issues = y %}
{% set direct, issue = issues[0]['direct'], issues[0]['issue'] %}
{% set cve_name = "{{issue.issue.name}}" %}
{% if is_tracked %}
{% affected = "{{'YES' if issue.affected else 'NO'}}" %}
{% resolved = "{{'YES' if issue.resolved else 'NO'}}" %}
{% else %}
{% if direct %}
{% affected = "{{'YES' if issue.affected else 'NO'}}" %}
{% resolved = "NO" %}
{% else %}
{% affected = "YES" %}
{% resolved = "NO" %}
{% endif %}
{% endif %}
{{prefix}}{{sep}}{{cve_name}}{{sep}}{{affected}}{{sep}}{{resolved}}
{% endfor %}
{% endfor %}
{% endfor %}
{% endfor %}