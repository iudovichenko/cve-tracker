{% extends "base.html" %}
{% block title %}{{obj.name}}-{{obj.version}}{% endblock %}
{% block content %}
    <a name="top"></a>
    <h1>{{obj.name}} {{obj.version}}</h1>

    <h2>Distribution Packages</h2>
    <a href="#top">Back to top</a>
    <table>
        <tr>
            <th>Package</th>
            <th>Version</th>
            <th>Distribution</th>
        </tr>
        {% for x in obj.distribution_packages %}
            <tr>
                <td><a href="../source-project/{{x.source_package.project.id}}.html">{{x.name}}</a></td>
                <td><a href="../distribution-package/{{x.id}}.html">{{x.version}}</a></td>
                <td><a href="../distribution/{{x.distribution.id}}.html">{{x.distribution}}</a></td>
            </tr>
        {% endfor %}
    </table>

    <h2>Product Packages</h2>
    <a href="#top">Back to top</a>
    <table>
        <tr>
            <th>Package</th>
            <th>Version</th>
            <th>Product</th>
        </tr>
        {% for x in obj.product_packages %}
            <tr>
                <td><a href="../source-project/{{x.source_package.project.id}}.html">{{x.source_package.name}}</a></td>
                <td><a href="../product-package/{{x.id}}.html">{{x.version}}</a></td>
                <td><a href="../product/{{x.product.id}}.html">{{x.product}}</a></td>
            </tr>
        {% endfor %}
    </table>

    <h2>Advisories</h2>
    <a href="#top">Back to top</a>
    <ul>
        {% for x in obj.advisories %}
        <li><a href="../advisory/{{x.id}}.html">{{x.name}}</a></li>
        {% endfor %}
    </ul>

    <h2>CVEs</h2>
    <a href="#top">Back to top</a>
    <table>
        <tr>
            <th>CVE</th>
            <th>Affected</th>
            <th>Resolved</th>
        </tr>
        {% set related_issues = obj.related_issues(merge=True) %}
        {% for _,x in related_issues|dictsort %}
            {% set is_tracked, issues = x['tracked'], x['issues'] %}
            {% set issue = issues[0]['issue'] %}
        <tr>
            {% if is_tracked %}
            <td><a href="../cve/{{issue.issue.id}}.html">{{issue.issue.name}}</a></td>
            <td bgcolor="{{'red' if issue.affected else 'green'}}">{{issue.affected}}</td>
            <td bgcolor="{{'green' if issue.resolved else 'red'}}">{{issue.resolved}}</td>
            {% else %}
            <td><a href="../cve/{{issue.issue.id}}.html">{{issue.issue.name}}</a></td>
            <td bgcolor="lightgrey">N/A</td>
            <td bgcolor="red">No</td>
            {% endif %}
        </tr>
        {% endfor %}
    </table>
{% endblock %}
