
import re


class DebianVersion(object):
    def __init__(self, version):
        self.epoch = 0
        self.version = ''
        self.revision = ''
        self.suffix = ''
        self.mos_distribution = ''
        self.mos_suffix = ''
        self.full_version = version

        parts = self.full_version.split(':', maxsplit=1)
        if len(parts) == 2:
            self.epoch = parts.pop(0)

        re_version = r'^(.*)(~u\d{2}\.?\d{2})(.*)$'
        match = re.match(re_version, parts[0])
        if match:
            self.version = match.group(1)
            self.mos_distribution = match.group(2)
            self.mos_suffix = match.group(3)
        else:
            self.version = parts[0]
        parts = self.version.split('-', maxsplit=1)
        if len(parts) == 2:
            self.version = parts.pop(0)
        self.revision = parts[0]

        dfsg_version = r'^(.*)([+-]dfsg.*)$'
        match = re.match(dfsg_version, self.version)
        if match:
            self.version = match.group(1)
            self.suffix = match.group(2)
