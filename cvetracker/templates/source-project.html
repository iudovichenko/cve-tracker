{% extends "base.html" %}
{% block title %}{{obj.name}}{% endblock %}
{% block content %}
    <h1>{{obj.name}}</h1>

    <table>
        <tr>
            <th>Type</th>
            <td>{{obj.type}}</td>
        </tr>
        <tr>
            <th>Homepage</th>
            <td><a href="{{obj.homepage}}">{{obj.homepage}}</a></td>
        </tr>
        <tr>
            <th>Summary</th>
            <td>{{obj.summary}}</td>
        </tr>
        <tr>
            <th>CPE Names</th>
            <td>
                <table>
                    {% for x in obj.cpes %}
                    <tr>
                        <td>{{x.wfn.bind_to_fs()}}</td>
                    </tr>
                    {% endfor %}
                </table>
            </td>
        </tr>
    </table>

    <h2>Properties</h2>
    <table>
        {% for name, value in obj.properties() %}
        <tr>
            <th>{{name}}</th>
            <td>{{value}}</td>
        </tr>
        {% endfor %}
    </table>

    <h2>Source Packages</h2>
    <table>
        <tr>
            <th>Package</th>
            <th>Version</th>
        </tr>
        {% for x in obj.source_packages %}
            <tr>
                <td><a href="../source-project/{{x.project.id}}.html">{{x.name}}</a></td>
                <td><a href="../source-package/{{x.id}}.html">{{x.version}}</a></td>
            </tr>
        {% endfor %}
    </table>

    <h2>Distribution Packages</h2>
    <table>
        <tr>
            <th>Package</th>
            <th>Version</th>
            <th>Distribution</th>
            <th>Product Packages</th>
        </tr>
        {% for x in obj.distribution_packages %}
            <tr>
                <td><a href="../source-project/{{x.source_package.project.id}}.html">{{x.source_package.name}}</a></td>
                <td><a href="../distribution-package/{{x.id}}.html">{{x.version}}</a></td>
                <td><a href="../distribution/{{x.distribution.id}}.html">{{x.distribution}}</a></td>
                <td>
                    <table>
                        {% for y in x.product_packages %}
                            <tr>
                                <td><a href="../product-package/{{y.id}}.html">{{y.version}}</a></td>
                                <td><a href="../product/{{y.product.id}}.html">{{y.product}}</a></td>
                            </tr>
                        {% endfor %}
                    </table>
                </td>
            </tr>
        {% endfor %}
    </table>

    <h2>Product Packages</h2>
    <table>
        <tr>
            <th>Package</th>
            <th>Version</th>
            <th>Product</th>
            <th>Distribution</th>
        </tr>
        {% for x in obj.product_packages %}
            <tr>
                <td><a href="../source-project/{{x.source_package.project.id}}.html">{{x.source_package.name}}</a></td>
                <td><a href="../product-package/{{x.id}}.html">{{x.version}}</a></td>
                <td><a href="../product/{{x.product.id}}.html">{{x.product}}</a></td>
                <td><a href="../distribution/{{x.distribution.id}}.html">{{x.distribution}}</a></td>
            </tr>
        {% endfor %}
    </table>

    <h2>CVEs</h2>
    <table>
        <tr>
            <th>CVE</th>
            <th>Product</th>
            <th>Distribution</th>
            <th>Affected</th>
            <th>Resolved</th>
        </tr>
        {% for x in obj.product_package_issues %}
            <tr>
                <td><a href="../cve/{{x.issue.id}}.html">{{x.issue.name}}</a></td>
                <td><a href="../product/{{x.product.id}}.html">{{x.product}}</a></td>
                <td><a href="../distribution/{{x.package.distribution.id}}.html">{{x.package.distribution}}</a></td>
                <td bgcolor="{{'red' if x.affected else 'green'}}">{{x.affected}}</td>
                <td bgcolor="{{'green' if x.resolved else 'red'}}">{{x.resolved}}</td>
            </tr>
        {% endfor %}
    </table>
{% endblock %}
