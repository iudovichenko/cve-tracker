{% extends "base.html" %}
{% block title %}{{obj.name}}{% endblock %}
{% block content %}
    <h1>{{obj.name}}</h1>
    <table>
        <tr>
            <td><a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name={{obj.name}}">MITRE</a></td>
            <td><a href="https://nvd.nist.gov/vuln/detail/{{obj.name}}">NVD</a></td>
        </tr>
    </table>

    <h2>Description</h2>
    <p>{{obj.subject}}</p>

    {% set cvss = obj.cvss2 %}
    {% if cvss %}
    <h2>CVSS v2 metrics</h2>
    <table>
        <tr>
            <th>CVSS V2 Score</th>
            <td>{{cvss.base_score|string}}</td>
        </tr>
        <tr>
            <th>CVSS V2 Vector</th>
            <td><a href="https://nvd.nist.gov/vuln-metrics/cvss/v2-calculator?vector={{cvss.vector}}">{{cvss.vector}}</a></td>
        </tr>
    </table>
    {% endif %}

    {% set cvss = obj.cvss3 %}
    {% if cvss %}
    <h2>CVSS v3 metrics</h2>
    <table>
        <tr>
            <th>CVSS V3 Score</th>
            <td>{{cvss.base_score|string}}</td>
        </tr>
        <tr>
            <th>CVSS V3 Vector</th>
            <td><a href="https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector={{cvss.vector}}">{{cvss.vector}}</a></td>
        </tr>
    </table>
    {% endif %}

    <h2>Advisories</h2>
    <ul>
        {% for x in obj.advisories %}
        <li><a href="../advisory/{{x.id}}.html">{{x.name}}</a></li>
        {% endfor %}
    </ul>

    <h2>Affects</h2>
    <table>
        <tr>
            <th>Package</th>
            <th>Version</th>
            <th>Affected</th>
            <th>Resolved</th>
        </tr>
        {% for x in obj.source_package_issues %}
            <tr>
                <td><a href="../source-project/{{x.package.project.id}}.html">{{x.package.name}}</a></td>
                <td><a href="../source-package/{{x.package.id}}.html">{{x.package.version}}</a></td>
                <td bgcolor="{{'red' if x.affected else 'green'}}">{{x.affected}}</td>
                <td bgcolor="{{'green' if x.resolved else 'red'}}">{{x.resolved}}</td>
            </tr>
        {% endfor %}
    </table>

    <h2>Affected Distribution</h2>
    <table>
        <tr>
            <th>Package</th>
            <th>Version</th>
            <th>Distribution</th>
            <th>Affected</th>
            <th>Resolved</th>
        </tr>
        {% for x in obj.distribution_package_issues %}
            <tr>
                <td><a href="../source-project/{{x.package.source_package.project.id}}.html">{{x.package.name}}</a></td>
                <td><a href="../distribution-package/{{x.package.id}}.html">{{x.package.version}}</a></td>
                <td><a href="../distribution/{{x.distribution.id}}.html">{{x.distribution}}</a></td>
                <td bgcolor="{{'red' if x.affected else 'green'}}">{{x.affected}}</td>
                <td bgcolor="{{'green' if x.resolved else 'red'}}">{{x.resolved}}</td>
            </tr>
        {% endfor %}
    </table>

    <h2>Affected Product</h2>
    <table>
        <tr>
            <th>Package</th>
            <th>Version</th>
            <th>Product</th>
            <th>Affected</th>
            <th>Resolved</th>
        </tr>
        {% for x in obj.product_package_issues %}
            <tr>
                <td><a href="../source-project/{{x.package.source_package.project.id}}.html">{{x.package.name}}</a></td>
                <td><a href="../product-package/{{x.package.id}}.html">{{x.package.version}}</a></td>
                <td><a href="../product/{{x.product.id}}.html">{{x.product}}</a></td>
                <td bgcolor="{{'red' if x.affected else 'green'}}">{{x.affected}}</td>
                <td bgcolor="{{'green' if x.resolved else 'red'}}">{{x.resolved}}</td>
            </tr>
        {% endfor %}
    </table>

    <h2>References</h2>
    <ul>
        {% for _,x in obj.properties(name='reference')|sort %}
        <li><a href="{{x}}">{{x}}</a></li>
        {% endfor %}
    </ul>
{% endblock %}
